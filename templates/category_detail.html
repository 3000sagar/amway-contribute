{% extends 'base.html' %}
{% load static %}

{% block title %}{{ category.name }} | Amway Contribute{% endblock %}

{% block content %}
<div class="w-full flex gap-6">

  <!-- ================================================= -->
  <!-- LEFT SIDEBAR -->
  <!-- ================================================= -->
  <aside class="hidden md:block w-56 bg-white dark:bg-gray-900 rounded-xl p-4 sticky top-24">
    <h3 class="font-bold mb-3">Other Categories</h3>
    <ul class="space-y-2">
      {% for cat in other_categories %}
      <li>
        <a href="{% url 'categories:category_detail' cat.slug %}"
           class="block px-3 py-2 rounded hover:bg-gray-100 dark:hover:bg-gray-800">
          {{ cat.name }}
        </a>
      </li>
      {% endfor %}
    </ul>
  </aside>

  <!-- ================================================= -->
  <!-- RIGHT CONTENT AREA -->
  <!-- ================================================= -->
  <div class="flex-1">

<!-- ================================================= -->
<!-- â­ LEVEL-2 GEN-Z HERO BANNER (BRIGHT MODE FIXED) -->
<!-- ================================================= -->

{% with first_product=products.0 %}
{% if first_product %}
<div class="swiper catHeroSwiper w-full h-[260px] sm:h-[330px] md:h-[360px] mb-10 rounded-[28px] overflow-hidden">

    <div class="swiper-wrapper">

        <div class="swiper-slide">

            <div id="genz-banner"
                 class="relative w-full h-full rounded-[28px] overflow-hidden flex items-center px-6 sm:px-10">

                <!-- BACKGROUND BLUR -->
                <div class="absolute inset-0">
                    <img src="{{ category.image.url }}"
                         class="w-full h-full object-cover blur-xl opacity-40 scale-110 rounded-[28px]">
                </div>

                <!-- ðŸ”¥ LIGHT MODE DARK OVERLAY (fix visibility) -->
                <div class="absolute inset-0 rounded-[28px]
                            bg-black/25 dark:bg-transparent"></div>

                <!-- ANIMATED WAVY GRADIENT -->
                <div class="absolute inset-0 rounded-[28px] animate-gradientFlow 
                    bg-[radial-gradient(circle_at_top_left,rgba(255,0,200,0.45),transparent_65%),
                       radial-gradient(circle_at_bottom_right,rgba(0,200,255,0.45),transparent_65%)]
                    dark:bg-[radial-gradient(circle_at_top_left,rgba(255,0,200,0.35),transparent_70%),
                       radial-gradient(circle_at_bottom_right,rgba(0,200,255,0.35),transparent_70%)]">
                </div>

                <!-- FLOATING PARTICLES -->
                <div class="absolute inset-0 pointer-events-none overflow-hidden rounded-[28px]">
                    <span class="particle"></span>
                    <span class="particle"></span>
                    <span class="particle"></span>
                    <span class="particle"></span>
                </div>

                <!-- LEFT TEXT -->
                <div class="relative z-20 w-[65%] flex flex-col gap-4 animate-fadeUp">

                    <!-- â­ BRIGHT MODE TEXT FIX -->
                    <h2 class="text-3xl sm:text-4xl md:text-5xl font-extrabold
                               text-gray-900 dark:text-white
                               drop-shadow-xl leading-tight">
                        Explore {{ category.name }}
                    </h2>

                    <p class="text-gray-800 dark:text-white/90
                              text-base sm:text-lg leading-relaxed max-w-xl">
                        Curated {{ category.name }} essentials crafted for better well-being.
                    </p>

                    <a href="#products"
                       class="px-6 py-2 bg-white dark:bg-white/90 
                              text-black rounded-xl shadow-lg font-semibold
                              text-sm sm:text-base w-fit hover:scale-105 transition">
                        Download Now
                    </a>
                </div>

                <!-- PRODUCT IMAGE (PARALLAX FLOAT) -->
                <div id="parallax-img"
                     class="relative z-20 w-[28%] flex justify-center items-center transition-transform duration-300">

                    <!-- â­ adaptive background -->
                    <div class="bg-white/80 dark:bg-white/20 
                                backdrop-blur-xl p-5 rounded-2xl shadow-2xl border border-white/40">
                        <img src="{{ first_product.image.url }}"
                             class="w-[120px] sm:w-[160px] md:w-[200px] object-contain drop-shadow-2xl">
                    </div>
                </div>

            </div>

        </div>

    </div>

    <div class="swiper-pagination"></div>
</div>
{% endif %}
{% endwith %}


      <!-- ================================================= -->
      <!-- CATEGORY TITLE + DESCRIPTION -->
      <!-- ================================================= -->
      <div id="products" class="mb-4">
        <h1 class="text-xl sm:text-2xl font-bold">{{ category.name }}</h1>
        <p class="text-gray-600 dark:text-gray-300 leading-relaxed">{{ category.description }}</p>
      </div>

      <!-- ================================================= -->
      <!-- PRODUCT GRID -->
      <!-- ================================================= -->
      {% if products %}
      <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">

        {% for product in products %}
        <a href="{% url 'gallery:product_detail' product.slug %}"
           class="block bg-white dark:bg-gray-900 rounded-2xl p-3 shadow hover:shadow-lg transition">

          <div class="w-full h-36 flex items-center justify-center bg-gray-100 rounded-xl overflow-hidden">
            {% if product.image %}
              <img src="{{ product.image.url }}" class="max-h-full object-contain">
            {% else %}
              <div class="w-full h-full bg-gray-200 dark:bg-gray-700 rounded-xl"></div>
            {% endif %}
          </div>

          <h3 class="mt-3 font-semibold text-sm line-clamp-2">{{ product.name }}</h3>

          {% if product.brand %}
            <p class="text-xs text-gray-500">{{ product.brand.name }}</p>
          {% endif %}
        </a>
        {% endfor %}

      </div>

      {% else %}
      <div class="py-20 text-center text-gray-600 dark:text-gray-300">
        <p class="font-semibold">No products found.</p>
      </div>
      {% endif %}

  </div>
</div>


<!-- ======================================================= -->
<!-- â­ SWIPER INIT -->
<!-- ======================================================= -->
<script>
new Swiper(".catHeroSwiper", {
    slidesPerView: 1,
    loop: true,
    autoplay: { delay: 3000, disableOnInteraction: false },
    speed: 900,
    effect: "fade",
    fadeEffect: { crossFade: true },
    pagination: { el: ".swiper-pagination", clickable: true },
});
</script>

<!-- ======================================================= -->
<!-- â­ LEVEL-2 GEN-Z CSS -->
<!-- ======================================================= -->

<style>
/* Animated Gradient Flow */
@keyframes gradientFlow {
  0% {opacity: .6; transform: scale(1);}
  50% {opacity: .75; transform: scale(1.05);}
  100% {opacity: .6; transform: scale(1);}
}
.animate-gradientFlow {
  animation: gradientFlow 7s ease-in-out infinite;
}

/* Fade-up animation */
@keyframes fadeUp {
  0% {opacity: 0; transform: translateY(20px);}
  100% {opacity: 1; transform: translateY(0);}
}
.animate-fadeUp {
  animation: fadeUp 1.2s ease-out;
}

/* Floating Particles */
.particle {
  position: absolute;
  width: 14px;
  height: 14px;
  background: rgba(255,255,255,0.25);
  border-radius: 50%;
  filter: blur(6px);
  animation: floatParticle 8s infinite linear;
}
.particle:nth-child(1) {top: 20%; left: 10%; animation-duration: 7s;}
.particle:nth-child(2) {top: 60%; left: 30%; animation-duration: 9s;}
.particle:nth-child(3) {top: 40%; left: 80%; animation-duration: 6s;}
.particle:nth-child(4) {top: 75%; left: 55%; animation-duration: 10s;}

@keyframes floatParticle {
  0% {transform: translateY(0) translateX(0) scale(1);}
  50% {transform: translateY(-25px) translateX(10px) scale(1.2);}
  100% {transform: translateY(0) translateX(0) scale(1);}
}

/* Parallax effect */
#genz-banner:hover #parallax-img {
  transform: translateY(-4px) translateX(4px) scale(1.03);
}
</style>

{% endblock %}
